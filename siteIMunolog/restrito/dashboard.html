<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IMUNOLOG - Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
  <style>
    ::-webkit-scrollbar {
      width: 0px;
      background: transparent;
    }

    :root {
      --primary-color: #2c3e50;
      --secondary-color: #ecf0f1;
      --accent-color: #007bff;
      --danger-color: #e74c3c;
      --bg-light: #ffffff;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      --border-radius: 12px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: var(--secondary-color);
      display: flex;
    }

    /* SIDEBAR */
    .sidebar {
      width: 240px;
      background-color: var(--primary-color);
      color: white;
      padding: 30px 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
      min-height: 100vh;
    }

    .avatar {
      width: 80px;
      height: 80px;
      background-color: #34495e;
      border-radius: 50%;
    }

    .user-info {
      text-align: center;
    }

    .user-info h3 {
      margin-top: 10px;
      font-size: 1.2em;
    }

    .user-info p {
      font-size: 0.8em;
      color: #bdc3c7;
    }

    .nav {
      list-style: none;
      width: 100%;
      padding: 0;
    }

    .nav li {
      margin: 10px 0;
    }

    .nav a {
      color: white;
      text-decoration: none;
      display: block;
      padding: 10px;
      border-radius: 8px;
      transition: background 0.3s;
    }

    .nav a:hover {
      background-color: #34495e;
    }

    /* MAIN CONTENT */
    .main {
      flex: 1;
      padding: 30px;
      display: flex;
      flex-direction: column;
      gap: 30px;
    }

    .kpis {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }

    .card {
      flex: 1;
      background-color: var(--bg-light);
      padding: 20px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);

      min-width: 20px;
    }

    .card h4 {
      font-size: 0.9em;
      margin-bottom: 5px;
    }

    .card p {
      font-size: 1.6em;
      font-weight: bold;
      color: var(--accent-color);
    }

    .charts {
      display: grid;
      grid-template-columns: 680fr 4fr;
      gap: 20px;
    }

    .chart-box {
      width: 100%;
      background-color: var(--bg-light);
      padding: 55px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      height: 420px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .chart-box canvas {
      flex-grow: 1.5;
    }

    .chart-box select {
      padding: 6px 8px;
      margin-bottom: 4px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 1em;
      background-color: var(--secondary-color);
      color: #2c3e50;
      transition: 0.3s;
    }

    .chart-box select:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 5px var(--accent-color);
      background-color: var(--bg-light);
    }

    .combined-visualization {
      display: flex;
      gap: 50px;
      background-color: var(--bg-light);
      padding: 30px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      margin-bottom: 450px;
    }

    .area-chart-container {
      flex: 2;
      height: 250px;
      display: flex;
      flex-direction: column;
    }

    .area-chart-container h4 {
      margin-bottom: 20px;
    }

    .area-chart-container canvas {
      flex-grow: 1;
    }

    .calendar-container {
      flex: 1;
      text-align: center;
    }

    .calendar-container h4 {
      margin-bottom: 10px;
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }

    .calendar-grid div {
      padding: 10px;
      background-color: #ecf0f1;
      border-radius: 8px;
      font-size: 0.9em;
      text-align: center;
    }

    .calendar-grid .highlight {
      background-color: var(--accent-color);
      color: white;
    }

    .calendar-grid .alert-date {
      background-color: var(--danger-color);
      color: white;
    }
  </style>

</head>

<body>
  <div class="sidebar">
    <div class="avatar">
      <img src="../imagem/menina.png" alt="Logo IMUNOTRACK"
        style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">
    </div>
    <div class="user-info">
      <h3>Fernanda Caramico</h3>
      <p>imunolog@ong.org</p>
    </div>
    <ul class="nav">

=======
      <li><a href="./dashboard.html">Painel de Desempenho</a></li>
      <li><a href="./alerta.html">Alertas</a></li>
      <li><a href="./configuracao.html">Configurações</a></li>
      <li><a href="./dados.html">Relatorio</a></li>
      <li><a href="./usuario.html">Usuario</a></li>
      <li><a href="../index.html">Sair</a></li>
    </ul>
  </div>
  <div class="main">
    <div class="kpis">
      <div class="card">
<<<<<<< HEAD
        <h4>Temperatura Ideal</h4>
        <p>2°C a 8ºC</p>
      </div>
      <div class="card">
        <h4>Temperatura Mais Alta Registrada</h4>
        <p style="color: #e74c3c;">9.2</p>
=======
        <h4>Transporte Atuais Em Riscos</h4>
        <br>
        <p style="color: var(--danger-color)">1/4 - Transportes <br> UU1234A - Caminhão:Sensor 004</p>
      </div>
      <div class="card">
        <h4>Risco de Perda de Produtos no Momento</h4>
        <br>
        <p style="color: var(--danger-color)">1.8% por Lote</p>
>>>>>>> 9286dd4a7bd8aa1ad7dd6a32fc99433619e2fee9
      </div>
      <div class="card">
        <h4>Transporte Feitos Sem Ocorrência</h4>
        <br>
        <p>96%</p>
      </div>
      <div class="card">

        <h4>Quantidade de Sensores em Leitura no Momento</h4>
        <br>
        <p>4</p>
      </div>
    </div>

    <div class="charts">
      <div class="chart-box">
        <h4>Variação da Temperatura por Sensor</h4>
        <select id="sensorSelect">
          <option value="sensor1">Sensor 1</option>
          <option value="sensor2">Sensor 2</option>
          <option value="sensor3">Sensor 3</option>
          <option value="sensor4">Sensor 4</option>
          <!-- Adicione mais opções de sensores conforme necessário -->
        </select>

        <canvas id="graficoLinha" style="height: 300px; width: 100%;"></canvas>

      </div>
      <div class="chart-box">
        <h4>Comparação de Ocorrências por Meses Decorridos(2025)</h4>
        <br>
        <canvas id="graficoTransporte"></canvas>
      </div>
    </div>
    <div class="combined-visualization">
      <div class="area-chart-container">
        <h4>Leituras de Temperatura por Sensor</h4>
        <canvas id="combinedChart"></canvas>
      </div>
      <div class="calendar-container">
        <h4>Calendario de Alertas</h4>
        <div class="calendar-grid">
        </div>
      </div>
    </div>


  </div>

  <script>
    // Gráfico de Linha Existente
    const ctxLinha = document.getElementById('graficoLinha').getContext('2d');
    const dadosSensores = {
      sensor1: [2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 2.8, 2.6], // Dados do Sensor 1
      sensor2: [2.4, 3.4, 4.4, 5.4, 6.4, 5.4, 4.4, 3.4], // Dados do Sensor 2
      sensor3: [2.8, 3.0, 4.0, 5.0, 6.0, 4.0, 3.3, 2.6], // Dados do Sensor 3
      sensor4: [3.2, 3.5, 4.3, 5.6, 6.5, 7.2, 8.3, 9.2], // Dados do Sensor 4
      // Adicione mais sensores aqui, se necessário
    };

    const labels = ['06:50h', '07:05h', '07:20h', '07:35h', '07:40h', '07:55h', '08:15h', '08:30h'];

    let grafico = new Chart(ctxLinha, {
      type: 'line',
      data: {
        labels: labels,
        datasets: [{
          label: 'Temperatura Atual (°C)',
          data: dadosSensores.sensor1, // Dados iniciais para o Sensor 1
          borderColor: '#007bff',
          backgroundColor: 'rgba(0, 123, 255, 0.1)',
          tension: 0.5
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: {
            min: 0,
            max: 10,
            ticks: {
              stepSize: 2
            },
            title: {
              display: true,
              text: 'Temperatura (°C)'

            }
          },
          x: {
            title: {
              display: true,
              text: 'Horário',

            }

          }
        }
      }
    });


    // Função para atualizar o gráfico com base na seleção do sensor
    document.getElementById('sensorSelect').addEventListener('change', function (event) {
      const sensorSelecionado = event.target.value;

      // Atualizar os dados do gráfico com os dados do sensor selecionado
      grafico.data.datasets[0].data = dadosSensores[sensorSelecionado];

      // Atualizar o título do gráfico
      grafico.data.datasets[0].label = `Temperatura Atual (°C) - ${sensorSelecionado}`;

      // Atualizar o gráfico
      grafico.update();
    });

    // Gráfico de Barras Atualizado para Transporte
    const ctxTransporte = document.getElementById('graficoTransporte').getContext('2d');
    new Chart(ctxTransporte, {
      type: 'bar',
      data: {
        labels: ['Janeiro', 'Fevereiro', 'Março', 'Abril'],
        datasets: [{
          label: 'Meses',
          data: [0, 0, 0, 1],
          backgroundColor: ['#3498db', '#9b59b6', '#f1c40f'],
          borderColor: ['#2980b9', '#8e44ad', '#f39c12'],
          borderWidth: 1,
          borderRadius: 8, // bordas arredondadas nas barras
          barThickness: 30
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: {
            beginAtZero: true,
            min: 0,  // Começar do valor 1
            max: 10, // Limitar até o valor 10
            title: {
              display: true,
              text: 'Ocorrências'
            },
            ticks: {
              stepSize: 1, // Definir incremento de 1
              callback: function (value) {
                return value; // Garantir que os valores são inteiros
              }
            }
          },
          x: {
            title: {
              display: true,
              text: 'Meses'
            }
          }
        },
        plugins: {
          legend: {
            display: false
          }
        }
      }
    });

    // Lógica para gerar o gráfico de linha com alertas por sensor
    const ctxCombined = document.getElementById('combinedChart').getContext('2d');

    const combinedChart = new Chart(ctxCombined, {
      type: 'line',
      data: {
        labels: ['06:50h', '07:05h', '07:20h', '07:35h', '07:40h', '07:55h', '08:15h', '08:30h'],
        datasets: [
          {
            label: 'Sensor 001 (°C)',
            data: [2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 2.8, 2.6],
            borderColor: 'orange',
            backgroundColor: 'rgba(255, 165, 0, 0.1)',
            tension: 0.4,
            pointBackgroundColor: 'orange',
            pointBorderColor: 'darkyorange',
            pointRadius: 5,
            pointHoverRadius: 7
          },
          {
            label: 'Sensor 002 (°C)',
            data: [2.4, 3.4, 4.4, 5.4, 6.4, 5.4, 4.4, 3.4],
            borderColor: 'steelblue',
            backgroundColor: 'rgba(70, 130, 180, 0.1)',
            tension: 0.4,
            pointBackgroundColor: 'blue',
            pointBorderColor: 'darkblue',
            pointRadius: 5,
            pointHoverRadius: 7
          },
          {
            label: 'Sensor 003 (°C)',
            data: [2.8, 3.0, 4.0, 5.0, 6.0, 4.0, 3.3, 2.6],
            borderColor: 'green',
            backgroundColor: 'rgba(0, 128, 0, 0.1)',
            tension: 0.4,
            pointBackgroundColor: 'green',
            pointBorderColor: 'darkgreen',
            pointRadius: 5,
            pointHoverRadius: 7
          },
          {
            label: 'Sensor 004 (°C)',
            data: [3.2, 3.5, 4.3, 5.6, 6.5, 7.2, 8.3, 9.2],
            borderColor: 'purple',
            backgroundColor: 'rgba(128, 0, 128, 0.1)',
            tension: 0.4,
            pointBackgroundColor: (context) => context.dataIndex === 7 ? 'red' : 'purple',
            pointBorderColor: (context) => context.dataIndex === 7 ? 'darkred' : 'darkmagenta',
            pointRadius: 5,
            pointHoverRadius: 7
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: {
            min: 0,
            max: 10,
            ticks: {
              stepSize: 2
            },
            title: {
              display: true,
              text: 'Temperatura (°C)'
            }
          },
          x: {
            title: {
              display: true,
              text: 'Horário'
            }
          }
        },
        plugins: {
          tooltip: {
            callbacks: {
              labelPointStyle: (context) => {
                const datasetIndex = context.datasetIndex;
                const dataIndex = context.dataIndex;
                const alertSensor = (datasetIndex === 0 && dataIndex === 5) || (datasetIndex === 1 && dataIndex === 1) || (datasetIndex === 3 && dataIndex === 7);
                return {
                  pointStyle: alertSensor ? 'triangle' : 'circle',
                };
              },
              afterLabel: (context) => {
                const datasetIndex = context.datasetIndex;
                const dataIndex = context.dataIndex;
                if ((datasetIndex === 0 && dataIndex === 5) || (datasetIndex === 1 && dataIndex === 1) || (datasetIndex === 3 && dataIndex === 7)) {
                  return ' Alerta Registrado';
                }
                return null;
              }
            }
          }
        }
      }
    });


    // Lógica para gerar o calendário com alertas dos sensores
    const calendarGrid = document.querySelector('.calendar-grid');
    const today = new Date();
    const currentMonth = today.getMonth();
    const currentYear = today.getFullYear();

    // Formatar data para o formato americano 'ano-mes-dia'
    function formatDate(date) {
      const year = date.getFullYear();
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const day = String(date.getDate()).padStart(2, '0');
      return `${year}-${month}-${day}`;
    }

    // Gerar calendário destacando as datas com alertas
    function generateCalendar(month, year, alertDates) {
      calendarGrid.innerHTML = '';
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const firstDayOfMonth = new Date(year, month, 1).getDay();

      for (let i = 0; i < firstDayOfMonth; i++) {
        const emptyDiv = document.createElement('div');
        calendarGrid.appendChild(emptyDiv);
      }

      for (let day = 1; day <= daysInMonth; day++) {
        const dayDiv = document.createElement('div');
        dayDiv.textContent = day;
        const currentDate = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;

        if (alertDates.includes(currentDate)) {
          dayDiv.classList.add('alert-date');
          dayDiv.title = 'Alerta de Variação de Temperatura';
        }

        calendarGrid.appendChild(dayDiv);
      }

      // Adiciona a legenda do calendário
      const legendContainer = document.createElement('div');
      legendContainer.style.marginTop = '15px';
      legendContainer.style.textAlign = 'left';

      const alertLegend = document.createElement('span');
      alertLegend.style.display = 'inline-block';
      alertLegend.style.width = '10px';
      alertLegend.style.height = '10px';
      alertLegend.style.borderRadius = '50%';
      alertLegend.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue('--danger-color');
      alertLegend.style.marginLeft = '15px';
      alertLegend.style.marginRight = '5px';

      const alertText = document.createTextNode('Alerta');

      legendContainer.appendChild(alertLegend);
      legendContainer.appendChild(alertText);

      calendarGrid.parentNode.appendChild(legendContainer);
    }

    // Definir as datas dos alertas com base nos sensores
    const alertOccurredDates = [
      formatDate(new Date(today.setDate(today.getDate())))
    ];

    // Gerar calendário com alertas
    generateCalendar(currentMonth, currentYear, alertOccurredDates);
  </script>
</body>

</html>